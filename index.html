<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PatuKrishi Pro</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --green:#2e8b57;
      --accent:#228b22;
      --muted:#6b6b6b;
      --card:#ffffff;
      --bg:#f4f9f4;
      --pill:#e9f7ed;
    }
    html { scroll-behavior: smooth; }
    body { font-family: "Arial",sans-serif; margin:0; padding:0; background:var(--bg); color:#222; }
    nav {
      background:var(--green);
      padding:0.9rem 1rem;
      color:#fff;
      display:flex;
      gap:1rem;
      justify-content:center;
      flex-wrap:wrap;
      position:sticky;
      top:0;
      z-index:1000;
    }
    nav a { color:#fff; text-decoration:none; font-weight:600; margin:0 6px; }
    header.site-head { text-align:center; padding:1.4rem 1rem; background:linear-gradient(0deg, rgba(46,139,87,0.98), rgba(46,139,87,0.9)); color:#fff; }
    header.site-head h1 { margin:0; font-size:1.6rem; }
    main { max-width:1100px; margin:1.2rem auto; padding:0 1rem; }
    section.card { background:var(--card); padding:1.2rem; border-radius:10px; box-shadow:0 6px 20px rgba(0,0,0,0.05); margin-bottom:1rem; }
    h2 { color:var(--green); margin-top:0; }
    .flex { display:flex; gap:1rem; align-items:center; flex-wrap:wrap; }
    select, input[type="text"], textarea, input[type="file"] { padding:10px; border-radius:8px; border:1px solid #ddd; font-size:14px; width:100%; box-sizing:border-box; }
    textarea { min-height:100px; resize:vertical; }
    button { background:var(--accent); color:#fff; border:none; padding:10px 14px; border-radius:8px; cursor:pointer; font-weight:600; }
    button.ghost { background:#fff; color:var(--accent); border:1px solid var(--accent); }
    .muted { color:var(--muted); font-size:13px; }
    .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:1rem; }
    .wide { width:100%; }
    .pill { background:var(--pill); padding:8px 10px; border-radius:999px; display:inline-block; margin:4px 4px 0 0; }
    #results { white-space:pre-wrap; background:#fff; padding:12px; border-radius:8px; box-shadow:inset 0 0 0 1px #eee; min-height:60px; }
    img.preview { max-width:100%; border-radius:8px; display:block; margin-top:8px; }
    /* Lens UI */
    #lensContainer { display:block; padding-top:12px; }
    #camera-container { position:relative; width:100%; max-width:700px; margin:12px auto; border-radius:10px; overflow:hidden; background:#000; }
    video, canvas, img { width:100%; height:auto; display:block; }
    #controls { display:flex; gap:8px; flex-wrap:wrap; align-items:center; justify-content:center; margin-top:10px; }
    .small { padding:8px 10px; font-size:14px; }
    .note { font-size:13px; color:var(--muted); margin-top:6px; }
    footer { text-align:center; padding:14px 8px; color:var(--muted); font-size:13px; }
    @media(max-width:800px){
      .grid-2 { grid-template-columns:1fr; }
      nav { gap:6px; padding:0.6rem; }
    }
  </style>

  <!-- Tesseract.js v4 -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
</head>
<body>
  <nav>
    <a href="#home">Home</a>
    <a href="#crops">Crop Advisory</a>
    <a href="#weather">Weather</a>
    <a href="#krishi">Chatbot</a>
    <a href="#lens">Lens</a>
    <a href="#contact">Contact</a>
  </nav>

  <header class="site-head">
    <h1>üåæ PatuKrishi Pro ‚Äî Ideas & Innovations for Indian Farmers</h1>
  </header>

  <main>
    <!-- HOME / INTRO -->
    <section id="home" class="card">
      <h2>Welcome to PatuKrishi Pro</h2>
      <p class="muted"Welcome to PatuKrishi Pro ‚Äì Your all-in-one farming guide.</h2>
      <p><strong>PatuKrishi</strong> is an innovative agricultural technology solution designed to empower farmers by providing precise and timely information crucial for successful farming. This smart product helps farmers determine the optimal cropping season for specific crops based on their region, ensuring better yields and reduced risks.</p>
      <p>Beyond just cropping advice, PatuKrishi integrates advanced climate forecasting and precipitation prediction, allowing farmers to plan their activities around weather patterns effectively. One of its standout features is the ability to analyze soil fertility simply by capturing a photo, leveraging AI-driven image recognition to give instant, accurate feedback about soil health.</p>
      <p>Complementing these features, PatuKrishi includes an intelligent AI assistant (in the Pro version) that responds to farmers‚Äô questions in real-time, offering expert guidance on a wide range of agricultural topics in regional languages.</p>
      <p>The product is offered in two versions: the standard PatuKrishi with essential features at an affordable price, and PatuKrishi Pro, which includes the full suite of AI capabilities for enhanced support.</p>
      <p>With a three-year guarantee and free technical support, PatuKrishi is committed to making modern agricultural innovations accessible and reliable, ultimately helping farmers increase productivity, reduce uncertainty, and achieve sustainable growth.</p>
      <p><strong>Tagline:</strong> ‚ÄúIdeas and Innovations‚Äù ‚Äî blending technology with traditional farming wisdom to transform rural agriculture.</p>
      <hr/>
      <p><strong>‡§™‡§ü‡•Å‡§ï‡•É‡§∑‡§ø</strong> ‡§è‡§ï ‡§Ö‡§≠‡§ø‡§®‡§µ ‡§ï‡•É‡§∑‡§ø ‡§™‡•ç‡§∞‡•å‡§¶‡•ç‡§Ø‡•ã‡§ó‡§ø‡§ï‡•Ä ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§® ‡§π‡•à ‡§ú‡§ø‡§∏‡•á ‡§∏‡§´‡§≤ ‡§ñ‡•á‡§§‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§∏‡§ü‡•Ä‡§ï ‡§î‡§∞ ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§ï‡•á ‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§∂‡§ï‡•ç‡§§ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡§ø‡§ú‡§º‡§æ‡§á‡§® ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§</p>
      <p>‡§Ø‡§π ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§â‡§§‡•ç‡§™‡§æ‡§¶ ‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§â‡§®‡§ï‡•á ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§∑‡•ç‡§ü‡§§‡§Æ ‡§´‡§∏‡§≤ ‡§Æ‡•å‡§∏‡§Æ ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§¨‡•á‡§π‡§§‡§∞ ‡§™‡•à‡§¶‡§æ‡§µ‡§æ‡§∞ ‡§î‡§∞ ‡§ï‡§Æ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§</p>
      <p>‡§™‡§ü‡•Å‡§ï‡•É‡§∑‡§ø ‡§â‡§®‡•ç‡§®‡§§ ‡§ú‡§≤‡§µ‡§æ‡§Ø‡•Å ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§® ‡§î‡§∞ ‡§µ‡§∞‡•ç‡§∑‡§æ ‡§ï‡•Ä ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø‡§µ‡§æ‡§£‡•Ä ‡§ï‡•ã ‡§è‡§ï‡•Ä‡§ï‡•É‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§ï‡§ø‡§∏‡§æ‡§® ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•á ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§Ö‡§™‡§®‡•Ä ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§¨‡§®‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§</p>
      <p>‡§è‡§ï ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ ‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§ñ‡•Ä‡§Ç‡§ö‡§ï‡§∞ ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•Ä ‡§â‡§∞‡•ç‡§µ‡§∞‡§§‡§æ ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ ‡§π‡•à, ‡§ú‡•ã ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•á ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§§‡§§‡•ç‡§ï‡§æ‡§≤, ‡§∏‡§ü‡•Ä‡§ï ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§Ü‡§à-‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§õ‡§µ‡§ø ‡§™‡§π‡§ö‡§æ‡§® ‡§ï‡§æ ‡§≤‡§æ‡§≠ ‡§â‡§†‡§æ‡§§‡•Ä ‡§π‡•à‡•§</p>
      <p>‡§™‡§ü‡•Å‡§ï‡•É‡§∑‡§ø ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§Æ‡§æ‡§® ‡§è‡§Ü‡§à ‡§∏‡§π‡§æ‡§Ø‡§ï (‡§™‡•ç‡§∞‡•ã ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§Æ‡•á‡§Ç) ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à ‡§ú‡•ã ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§∏‡§Æ‡§Ø ‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§µ‡§æ‡§≤‡•ã‡§Ç ‡§ï‡§æ ‡§ú‡§µ‡§æ‡§¨ ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•Ä‡§Ø ‡§≠‡§æ‡§∑‡§æ‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§ï‡•É‡§∑‡§ø ‡§µ‡§ø‡§∑‡§Ø‡•ã‡§Ç ‡§™‡§∞ ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§® ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§</p>
      <p>‡§Ø‡§π ‡§â‡§§‡•ç‡§™‡§æ‡§¶ ‡§¶‡•ã ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•à: ‡§Æ‡§æ‡§®‡§ï ‡§™‡§ü‡•Å‡§ï‡•É‡§∑‡§ø ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§´‡§æ‡§Ø‡§§‡•Ä ‡§Æ‡•Ç‡§≤‡•ç‡§Ø ‡§™‡§∞ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ‡§è‡§Å ‡§π‡•à‡§Ç, ‡§î‡§∞ ‡§™‡§ü‡•Å‡§ï‡•É‡§∑‡§ø ‡§™‡•ç‡§∞‡•ã, ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§è‡§Ü‡§à ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§∏‡•Ç‡§ü ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡•§</p>
      <p>‡§§‡•Ä‡§® ‡§∏‡§æ‡§≤ ‡§ï‡•Ä ‡§ó‡§æ‡§∞‡§Ç‡§ü‡•Ä ‡§î‡§∞ ‡§Æ‡•Å‡§´‡•ç‡§§ ‡§§‡§ï‡§®‡•Ä‡§ï‡•Ä ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§ï‡•á ‡§∏‡§æ‡§•, ‡§™‡§ü‡•Å‡§ï‡•É‡§∑‡§ø ‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï ‡§ï‡•É‡§∑‡§ø ‡§®‡§µ‡§æ‡§ö‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•Å‡§≤‡§≠ ‡§î‡§∞ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§¶‡•ç‡§ß ‡§π‡•à‡•§</p>
      <p><strong>‡§ü‡•à‡§ó‡§≤‡§æ‡§á‡§®:</strong> "‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§î‡§∞ ‡§®‡§µ‡§æ‡§ö‡§æ‡§∞" ‚Äî ‡§™‡§æ‡§∞‡§Ç‡§™‡§∞‡§ø‡§ï ‡§ï‡•É‡§∑‡§ø ‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§§‡§ï‡§®‡•Ä‡§ï ‡§ï‡§æ ‡§Æ‡§ø‡§∂‡•ç‡§∞‡§£ ‡§ï‡§∞ ‡§ó‡•ç‡§∞‡§æ‡§Æ‡•Ä‡§£ ‡§ï‡•É‡§∑‡§ø ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡§æ ‡§Æ‡§ø‡§∂‡§®‡•§.</p>
    </section>

    <!-- CROP ADVISORY -->
    <section id="crops" class="card">
      <h2>Crop Advisory</h2>
      <div class="grid-2">
        <div>
          <label>Select State</label>
          <select id="stateSelect" onchange="updateCropInfoBySeason()">
            <option value="">-- Select State --</option>
            <option>Andhra Pradesh</option><option>Arunachal Pradesh</option><option>Assam</option><option>Bihar</option>
            <option>Chhattisgarh</option><option>Goa</option><option>Gujarat</option><option>Haryana</option>
            <option>Himachal Pradesh</option><option>Jharkhand</option><option>Karnataka</option><option>Kerala</option>
            <option>Madhya Pradesh</option><option>Maharashtra</option><option>Manipur</option><option>Meghalaya</option>
            <option>Mizoram</option><option>Nagaland</option><option>Odisha</option><option>Punjab</option>
            <option>Rajasthan</option><option>Sikkim</option><option>Tamil Nadu</option><option>Telangana</option>
            <option>Tripura</option><option>Uttar Pradesh</option><option>Uttarakhand</option><option>West Bengal</option>
          </select>
        </div>
        <div>
          <label>Select Season</label>
          <select id="seasonSelect" onchange="updateCropInfoBySeason()">
            <option value="">-- Select Season --</option>
            <option value="Rabi">Rabi</option>
            <option value="Kharif">Kharif</option>
            <option value="Zaid">Zaid</option>
          </select>
        </div>
      </div>
      <div id="cropOutput" style="margin-top:12px;"></div>
    </section>

    <!-- SOIL FERTILITY MOCK -->
    <section id="fertility" class="card">
      <h2>üß™ Soil Fertility Check (Photo-Based Simulation)</h2>
      <p class="muted">Upload a soil photo and get a mock fertility estimate.</p>
      <input accept="image/*" id="soilPhotoInput" type="file" onchange="previewSoilImage()" />
      <div id="previewSoil"></div>
      <div style="margin-top:10px;">
        <button onclick="mockFertilityResult()">Check Fertility</button>
        <span id="fertilityResult" style="margin-left:12px; font-weight:600;"></span>
      </div>
    </section>

    <!-- WEATHER -->
    <section id="weather" class="card">
      <h2>üå¶Ô∏è India Weather Finder</h2>
      <div class="flex" style="gap:0.6rem;">
        <input id="cityInput" type="text" placeholder="Enter city or village (India)" />
        <button onclick="getWeatherByCity()">Search</button>
        <button onclick="getWeatherByLocation()">üìç Use My Location</button>
      </div>
      <div id="result" style="margin-top:12px;"></div>
    </section>

    <!-- KRISHI BOT (comprehensive) -->
    <section id="krishi" class="card">
      <h2>üåæ Krishi Bot ‚Äî Agriculture, Animals, Water, Fertilizer, Pesticide & Schemes</h2>

      <div id="languageSelect" style="margin-bottom:8px;">
        <label class="muted">Bot Language</label>
        <select id="language">
          <option value="en">English</option>
          <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
          <option value="roman">Hindi (Romanized)</option>
        </select>
        <button onclick="startRecognition()" class="small" style="margin-left:8px;">üé§ Mic</button>
      </div>

      <div id="chatbox" style="border:1px solid #eee; padding:10px; border-radius:8px; min-height:200px; background:#fff;"></div>

      <div style="display:flex; gap:8px; margin-top:10px; align-items:center;">
        <input id="userInput" type="text" placeholder="Type your message..." />
        <button onclick="sendMessage()">Send</button>
      </div>

      <details style="margin-top:12px;">
        <summary><strong>Examples</strong></summary>
        <ul class="muted">
          <li>‚ÄúHow to grow more from a piece of land‚Äù</li>
          <li>‚ÄúTypes of soil‚Äù</li>
          <li>‚ÄúWater management tips‚Äù</li>
          <li>‚ÄúPesticide safety‚Äù</li>
          <li>‚ÄúGovernment schemes for farmers‚Äù</li>
          <li>‚ÄúCM of Maharashtra‚Äù</li>
        </ul>
      </details>
    </section>

    <!-- LENS OCR + TRANSLATE (separate section) -->
    <section id="lens" class="card">
      <h2>üì∑ PatuKrishi Lens ‚Äî OCR + Translate (All Indian Languages)</h2>
      <p class="muted">Upload/capture an image, run OCR with the correct OCR languages, then choose an Indian language from the dropdown and click <strong>Translate</strong>.</p>

      <!-- Preview / Camera -->
      <div id="camera-container" style="display:none; margin-bottom:12px;">
        <video id="video" autoplay playsinline style="background:#000;"></video>
        <canvas id="overlay" style="display:none;"></canvas>
        <img id="uploadedImage" class="preview" style="display:none;" alt="uploaded image preview" />
      </div>

      <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
        <input id="imageInput" type="file" accept="image/*" />
        <button onclick="startCamera()" class="small">Start Camera</button>
        <button onclick="captureFromCamera()" class="small">Capture</button>
        <button onclick="loadImageFromInput()" class="small">Load Image</button>
      </div>

      <div id="controls" style="margin-top:10px;">
        <div style="min-width:220px;">
          <label class="muted">OCR languages (choose one or more)</label>
          <select id="ocrLangSelect" multiple style="min-width:220px; height:130px;"></select>
          <div class="note">Tip: select languages that match the script in the image (e.g., Hindi for Devanagari).</div>
        </div>

        <div style="min-width:220px;">
          <label class="muted">Translate To (choose one)</label>
          <select id="transTarget" style="min-width:220px; height:130px;"></select>
          <div class="note">After OCR: click <strong>Run OCR</strong>, then <strong>Translate</strong>.</div>
        </div>
      </div>

      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
        <button onclick="runOCRNow()">Run OCR</button>
        <button onclick="translateExtracted()" class="ghost">Translate</button>
        <button onclick="clearLens()" class="small ghost">Clear</button>
      </div>

      <div id="results" style="margin-top:12px;"></div>
      <textarea id="extractedText" placeholder="Extracted text will appear here..." style="margin-top:10px; width:100%;"></textarea>
      <div id="translatedBox" style="margin-top:12px;"></div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="card">
      <h2>Contact</h2>
      <p><strong>Phone:</strong> +91 98*** *****</p>
      <p><strong>Email:</strong> chanakyasahni8@gmail.com</p>
      <div class="muted">This Website is owned by Team - The Synergistic Trio</div>
    </section>
  </main>

  <footer>¬© PatuKrishi Pro</footer>

  <script>
    /* ------------------ Crop Data ------------------ */
    const cropData = {
      "Punjab": { "Rabi": "Wheat, Mustard, Barley", "Kharif": "Paddy, Cotton, Maize", "Zaid": "Moong, Watermelon, Cucumber" },
      "Rajasthan": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Bajra, Jowar, Moong", "Zaid": "Watermelon, Pumpkin, Cucumber" },
      "Maharashtra": { "Rabi": "Wheat, Chickpea, Safflower", "Kharif": "Cotton, Soybean, Tur", "Zaid": "Groundnut, Vegetables, Sunflower" },
      "Tamil Nadu": { "Rabi": "Maize, Sorghum, Pulses", "Kharif": "Rice, Sugarcane, Cotton", "Zaid": "Vegetables, Fruits, Green Gram" },
      "Uttar Pradesh": { "Rabi": "Wheat, Barley, Peas", "Kharif": "Rice, Maize, Arhar", "Zaid": "Cucumber, Moong, Pumpkin" },
      "West Bengal": { "Rabi": "Wheat, Mustard, Lentil", "Kharif": "Rice, Jute, Maize", "Zaid": "Green Gram, Vegetables, Fruits" },
      "Andhra Pradesh": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Arunachal Pradesh": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Assam": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Bihar": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Chhattisgarh": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Goa": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Gujarat": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Haryana": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Himachal Pradesh": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Jharkhand": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Karnataka": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Kerala": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Madhya Pradesh": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Manipur": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Meghalaya": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Mizoram": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Nagaland": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Odisha": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Sikkim": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Telangana": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Tripura": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" },
      "Uttarakhand": { "Rabi": "Wheat, Mustard, Gram", "Kharif": "Rice, Maize, Bajra", "Zaid": "Cucumber, Watermelon, Moong" }
    };

    function updateCropInfoBySeason(){
      const state = document.getElementById('stateSelect').value;
      const season = document.getElementById('seasonSelect').value;
      const out = document.getElementById('cropOutput');
      if (cropData[state] && cropData[state][season]) {
        out.innerHTML = `<div class="pill"><strong>${season} Crops in ${state}:</strong> ${cropData[state][season]}</div>`;
      } else {
        out.innerHTML = `<p class="muted"><em>No data available for the selected combination.</em></p>`;
      }
    }

    /* ---------- Soil fertility mock ---------- */
    function previewSoilImage() {
      const input = document.getElementById("soilPhotoInput");
      const preview = document.getElementById("previewSoil");
      preview.innerHTML = "";
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const img = document.createElement("img");
          img.src = e.target.result;
          img.className = 'preview';
          preview.appendChild(img);
        };
        reader.readAsDataURL(input.files[0]);
      }
    }
    function mockFertilityResult(){
      const options = ["High","Medium","Low"];
      const res = options[Math.floor(Math.random()*options.length)];
      document.getElementById("fertilityResult").innerText = "Fertility Estimate: " + res;
    }

    /* ---------- Weather (OpenWeather) ---------- */
    const apiKey = "7ab4aad915c97e3f0a93de8e8d570956";
    async function getWeatherByCity(){
      const city = document.getElementById("cityInput").value.trim();
      const out = document.getElementById("result");
      if (!city) { out.innerHTML = "‚ö†Ô∏è Please enter a place name!"; return; }
      out.innerHTML = "Loading weather...";
      try {
        const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)},IN&appid=${apiKey}&units=metric`);
        const data = await response.json();
        if (data.cod !== 200) {
          out.innerHTML = `‚ö†Ô∏è "${city}" not found, try GPS or a nearby town.`;
        } else {
          out.innerHTML = `<b>üìç ${data.name}:</b> ${data.main.temp} ¬∞C ‚Äî ${data.weather[0].description} <br>Humidity: ${data.main.humidity}% ¬∑ Wind: ${data.wind.speed} m/s`;
        }
      } catch(e){ out.innerHTML = "‚ö†Ô∏è Weather error"; console.error(e); }
    }
    function getWeatherByLocation(){
      const out = document.getElementById("result");
      if (!navigator.geolocation) { out.innerHTML = "‚ö†Ô∏è Geolocation not supported."; return; }
      out.innerHTML = "Getting location...";
      navigator.geolocation.getCurrentPosition(async pos => {
        try {
          const lat = pos.coords.latitude, lon = pos.coords.longitude;
          const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`);
          const data = await response.json();
          if (data.cod !== 200) out.innerHTML = `‚ùå ${data.message}`;
          else out.innerHTML = `<b>üìç ${data.name}:</b> ${data.main.temp} ¬∞C ‚Äî ${data.weather[0].description} <br>Humidity: ${data.main.humidity}% ¬∑ Wind: ${data.wind.speed} m/s`;
        } catch(e){ out.innerHTML = "‚ö†Ô∏è Weather error"; console.error(e); }
      }, ()=>{ out.innerHTML = "‚ö†Ô∏è Location access denied."; });
    }

    /* ---------- Krishi Bot (comprehensive) ---------- */
    const chatbox = document.getElementById("chatbox");
    const userInput = document.getElementById("userInput");
    const languageSelect = document.getElementById("language");

    const responses = {
      "hello":{en:"Hello! How are you doing?",hi:"‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Ü‡§™ ‡§ï‡•à‡§∏‡•á ‡§π‡•à‡§Ç?",roman:"Namaste! Aap kaise hain?"},
      "how are you":{en:"I'm a bot ‚Äî ready to help!",hi:"‡§Æ‡•à‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•Ç‡§Å!",roman:"Main madad ke liye tayyar hoon!"},
      "what is your name":{en:"My name is Krishi Bot.",hi:"‡§Æ‡•á‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§ï‡•É‡§∑‡•Ä ‡§¨‡•â‡§ü ‡§π‡•à‡•§",roman:"Mera naam Krishi Bot hai."},
      "thanks":{en:"Always here to help!",hi:"‡§π‡§Æ‡•á‡§∂‡§æ ‡§∏‡•á‡§µ‡§æ ‡§Æ‡•á‡§Ç!",roman:"Hamesha seva mein!"},
      "how to grow more from a piece of land": {
        en: "How to Grow More:\n- Intercropping\n- Crop Rotation\n- HYV Seeds\n- Organic Fertilizer\n- Drip Irrigation\n- Double Cropping\n- Greenhouse Farming\n- Weed Control",
        hi: "‡§è‡§ï ‡§π‡•Ä ‡§ú‡§º‡§Æ‡•Ä‡§® ‡§™‡§∞ ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§´‡§∏‡§≤ ‡§ï‡•à‡§∏‡•á ‡§â‡§ó‡§æ‡§è‡§Ç:\n- ‡§Æ‡§ø‡§∂‡•ç‡§∞ ‡§´‡§∏‡§≤ (Intercropping)\n- ‡§´‡§∏‡§≤ ‡§ö‡§ï‡•ç‡§∞ (Crop Rotation)\n- ‡§â‡§ö‡•ç‡§ö ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§ï ‡§¨‡•Ä‡§ú\n- ‡§ú‡•à‡§µ‡§ø‡§ï ‡§ñ‡§æ‡§¶\n- ‡§°‡•ç‡§∞‡§ø‡§™ ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à\n- ‡§¶‡•ã‡§π‡§∞‡•Ä ‡§´‡§∏‡§≤\n- ‡§ó‡•ç‡§∞‡•Ä‡§®‡§π‡§æ‡§â‡§∏ ‡§ñ‡•á‡§§‡•Ä\n- ‡§®‡§ø‡§∞‡§æ‡§à-‡§ó‡•Å‡§°‡§º‡§æ‡§à",
        roman: "Ek hi zameen par zyada fasal kaise ugaayein:\n- Mishrit fasal\n- Fasal chakra\n- Uchh utpadak beej\n- Jaivik khaad\n- Drip sinchaai\n- Dohri fasal\n- Greenhouse kheti\n- Niraai-gudaai"
      },
      "types of soil": { en: "Types of Soil in India:\n1. Alluvial Soil\n2. Black Soil\n3. Red Soil\n4. Laterite Soil\n5. Desert Soil\n6. Mountain Soil",
        hi:"‡§≠‡§æ‡§∞‡§§ ‡§Æ‡•á‡§Ç ‡§Æ‡•É‡§¶‡§æ ‡§ï‡•á ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞:\n1. ‡§ú‡§≤‡•ã‡§¢‡§º ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä\n2. ‡§ï‡§æ‡§≤‡•Ä ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä\n3. ‡§≤‡§æ‡§≤ ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä\n4. ‡§≤‡•á‡§ü‡§∞‡§æ‡§á‡§ü ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä\n5. ‡§Æ‡§∞‡•Å‡§∏‡•ç‡§•‡§≤‡•Ä‡§Ø ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä\n6. ‡§™‡§∞‡•ç‡§µ‡§§‡•Ä‡§Ø ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä",
        roman:"Bharat mein mrida ke prakar:\n1. Jalod mitti\n2. Kali mitti\n3. Laal mitti\n4. Laterite mitti\n5. Marusthal mitti\n6. Parvatiya mitti"
      },
      "water management": { en: "Tips:\n- Rainwater harvesting\n- Drip irrigation\n- Mulching\n- Traditional water systems\n- Groundwater recharge",
        hi:"‡§ü‡§ø‡§™‡•ç‡§∏:\n- ‡§µ‡§∞‡•ç‡§∑‡§æ ‡§ú‡§≤ ‡§∏‡§Ç‡§ö‡§Ø‡§®\n- ‡§°‡•ç‡§∞‡§ø‡§™ ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à\n- ‡§Æ‡§≤‡•ç‡§ö‡§ø‡§Ç‡§ó\n- ‡§™‡§æ‡§∞‡§Ç‡§™‡§∞‡§ø‡§ï ‡§ú‡§≤ ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä\n- ‡§≠‡•Ç‡§ú‡§≤ ‡§™‡•Å‡§®‡§∞‡•ç‡§≠‡§∞‡§£",
        roman:"Tips:\n- Varsha jal sanchayan\n- Drip sinchaai\n- Mulching\n- Paaramparik jal pranali\n- Bhoojal punarbharn"
      },
      "pesticide": { en: "Use registered pesticides, follow label instructions, wear PPE, avoid overuse and follow pre-harvest intervals.",
        hi: "‡§™‡§Ç‡§ú‡•Ä‡§ï‡•É‡§§ ‡§ï‡•Ä‡§ü‡§®‡§æ‡§∂‡§ï ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç, ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂ ‡§™‡§¢‡§º‡•á‡§Ç, ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§â‡§™‡§ï‡§∞‡§£ ‡§™‡§π‡§®‡•á‡§Ç ‡§î‡§∞ ‡§ì‡§µ‡§∞‡§Ø‡•Ç‡§ú‡§º ‡§∏‡•á ‡§¨‡§ö‡•á‡§Ç‡•§",
        roman: "Panjikrit keetnashak ka upyog karein, nirdesh padhein, suraksha upkaran pehnein."
      },
      "fertilizer": { en: "Use soil testing for fertilizer recommendations, balance NPK, prefer organic sources when possible.",
        hi: "‡§â‡§∞‡•ç‡§µ‡§∞‡§ï ‡§ï‡•Ä ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡•É‡§¶‡§æ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£ ‡§ï‡§∞‡•á‡§Ç, NPK ‡§∏‡§Ç‡§§‡•Å‡§≤‡§ø‡§§ ‡§∞‡§ñ‡•á‡§Ç, ‡§ú‡§π‡§æ‡§Ç ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã ‡§ú‡•à‡§µ‡§ø‡§ï ‡§∏‡•ç‡§∞‡•ã‡§§ ‡§Ö‡§™‡§®‡§æ‡§è‡§Å‡•§",
        roman: "Urvarak ke liye mrida parikshan karein, NPK santulit rakhein."
      },
      "animals": { en: "Farm animals: cows, buffaloes, goats, sheep, chickens. Focus on nutrition, vaccination, clean housing.",
        hi: "‡§ï‡•É‡§∑‡§ø ‡§™‡§∂‡•Å: ‡§ó‡§æ‡§Ø, ‡§≠‡•à‡§Ç‡§∏, ‡§¨‡§ï‡§∞‡•Ä, ‡§≠‡•á‡§°‡§º, ‡§Æ‡•Å‡§∞‡•ç‡§ó‡•Ä‡•§ ‡§™‡•ã‡§∑‡§£, ‡§ü‡•Ä‡§ï‡§æ‡§ï‡§∞‡§£ ‡§î‡§∞ ‡§∏‡§æ‡§´ ‡§Ü‡§µ‡§æ‡§∏ ‡§™‡§∞ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç‡•§",
        roman: "Krishi pashu: gaay, bhains, bakri, bhed, murgi. Poshan, tikaakaran, saaf aavaas."
      },
      "government schemes for farmers": { en: "Major Schemes:\n- PM-KISAN: direct income support\n- PMFBY: Crop insurance\n- KCC: Farm loans\n- eNAM: Online trading\n- Soil Health Card",
        hi: "‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Å:\n- ‡§™‡•Ä‡§è‡§Æ-‡§ï‡§ø‡§∏‡§æ‡§®\n- ‡§™‡•Ä‡§è‡§Æ‡§è‡§´‡§¨‡•Ä‡§µ‡§æ‡§à: ‡§´‡§∏‡§≤ ‡§¨‡•Ä‡§Æ‡§æ\n- ‡§ï‡§ø‡§∏‡§æ‡§® ‡§ï‡•ç‡§∞‡•á‡§°‡§ø‡§ü ‡§ï‡§æ‡§∞‡•ç‡§°\n- ‡§à-‡§®‡§æ‡§Æ: ‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§Æ‡§Ç‡§°‡•Ä\n- ‡§Æ‡•É‡§¶‡§æ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§ï‡§æ‡§∞‡•ç‡§°",
        roman: "Mukhya yojanaayein: PM-KISAN, PMFBY, KCC, eNAM, Soil Health Card"
      }
    };

    function appendMessage(sender, message){
      const d = document.createElement("div");
      d.style.padding = "6px 0";
      d.textContent = `${sender}: ${message}`;
      chatbox.appendChild(d);
      chatbox.scrollTop = chatbox.scrollHeight;
    }

    function sendMessage(){
      const msg = (userInput.value||"").trim();
      if (!msg) return;
      appendMessage("You", msg);
      userInput.value = "";
      let reply = "Sorry, I didn't understand that. Try: 'water management', 'types of soil', 'pesticide', 'fertilizer', 'animals', or 'government schemes for farmers'.";
      const lower = msg.toLowerCase();
      for (const k in responses){
        if (lower.includes(k)){
          const lang = languageSelect.value;
          reply = responses[k][lang] || responses[k].en;
          break;
        }
      }
      appendMessage("Krishi Bot", reply);
      try { const utter = new SpeechSynthesisUtterance(reply); utter.lang = (languageSelect.value==="hi"?"hi-IN":"en-US"); speechSynthesis.speak(utter); } catch(e){}
    }
    userInput.addEventListener("keypress", function(e){ if (e.key === "Enter") sendMessage(); });

    function startRecognition(){
      try {
        const lang = languageSelect.value==="hi" ? "hi-IN" : "en-US";
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = lang;
        recognition.start();
        recognition.onresult = function(ev){ const transcript = ev.results[0][0].transcript; userInput.value = transcript; sendMessage(); };
      } catch(e) { alert("Speech recognition not supported in this browser."); }
    }

    /* ---------- LENS OCR + Translate ---------- */

    // Populate OCR languages and translate target list (all Indian + fallback)
    const ocrLangs = [
      {code:"eng", name:"English"},
      {code:"hin", name:"Hindi (‡§π‡§ø‡§®‡•ç‡§¶‡•Ä)"},
      {code:"ben", name:"Bengali (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ)"},
      {code:"tam", name:"Tamil (‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç)"},
      {code:"tel", name:"Telugu (‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å)"},
      {code:"kan", name:"Kannada (‡≤ï‡≤®‡≥ç‡≤®‡≤°)"},
      {code:"mal", name:"Malayalam (‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç)"},
      {code:"ori", name:"Odia (‡¨ì‡¨°‡¨º‡¨ø‡¨Ü)"},
      {code:"guj", name:"Gujarati (‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä)"},
      {code:"mar", name:"Marathi (‡§Æ‡§∞‡§æ‡§†‡•Ä)"},
      {code:"pan", name:"Punjabi (‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä)"},
      {code:"urd", name:"Urdu (ÿßÿ±ÿØŸà)"},
      {code:"asm", name:"Assamese (‡¶Ö‡¶∏‡¶Æ‡ßÄ‡¶Ø‡¶º‡¶æ)"},
      {code:"san", name:"Sanskrit (‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§Æ‡•ç)"},
      {code:"mai", name:"Maithili (‡§Æ‡•à‡§•‡§ø‡§≤‡•Ä)"},
      {code:"nep", name:"Nepali (‡§®‡•á‡§™‡§æ‡§≤‡•Ä)"}
    ];

    const translateTargets = [
      {code:"hi", name:"Hindi"},
      {code:"bn", name:"Bengali"},
      {code:"ta", name:"Tamil"},
      {code:"te", name:"Telugu"},
      {code:"kn", name:"Kannada"},
      {code:"ml", name:"Malayalam"},
      {code:"or", name:"Odia"},
      {code:"gu", name:"Gujarati"},
      {code:"mr", name:"Marathi"},
      {code:"pa", name:"Punjabi"},
      {code:"ur", name:"Urdu"},
      {code:"as", name:"Assamese"},
      {code:"sa", name:"Sanskrit"},
      {code:"mai", name:"Maithili"},
      {code:"ne", name:"Nepali"},
      {code:"sd", name:"Sindhi"},
      {code:"ks", name:"Kashmiri"},
      {code:"doi", name:"Dogri"},
      {code:"kok", name:"Konkani"},
      {code:"bho", name:"Bhojpuri"},
      {code:"mni", name:"Manipuri"},
      {code:"en", name:"English"},
      {code:"fr", name:"French"},
      {code:"es", name:"Spanish"}
    ];

    (function populateLangs(){
      const ocrSelect = document.getElementById('ocrLangSelect');
      ocrLangs.forEach(l=>{
        const opt = document.createElement('option');
        opt.value = l.code; opt.textContent = `${l.name} (${l.code})`;
        if (l.code==='eng' || l.code==='hin') opt.selected=true;
        ocrSelect.appendChild(opt);
      });

      const transSelect = document.getElementById('transTarget');
      translateTargets.forEach(t=>{
        const opt = document.createElement('option');
        opt.value = t.code; opt.textContent = t.name;
        if (t.code==='hi') opt.selected=true;
        transSelect.appendChild(opt);
      });
    })();

    // State & CM data (full list for states in the select)
    const stateData = [
      {state:"Andhra Pradesh", capital:"Amaravati", cm:"N. Chandrababu Naidu"},
      {state:"Arunachal Pradesh", capital:"Itanagar", cm:"Pema Khandu"},
      {state:"Assam", capital:"Dispur", cm:"Himanta Biswa Sarma"},
      {state:"Bihar", capital:"Patna", cm:"Nitish Kumar"},
      {state:"Chhattisgarh", capital:"Raipur", cm:"Vishnu Deo Sai"},
      {state:"Goa", capital:"Panaji", cm:"Pramod Sawant"},
      {state:"Gujarat", capital:"Gandhinagar", cm:"Bhupendra Patel"},
      {state:"Haryana", capital:"Chandigarh", cm:"Nayab Singh Saini"},
      {state:"Himachal Pradesh", capital:"Shimla", cm:"Sukhvinder Singh Sukhu"},
      {state:"Jharkhand", capital:"Ranchi", cm:"Hemant Soren"},
      {state:"Karnataka", capital:"Bengaluru", cm:"Siddaramaiah"},
      {state:"Kerala", capital:"Thiruvananthapuram", cm:"Pinarayi Vijayan"},
      {state:"Madhya Pradesh", capital:"Bhopal", cm:"Mohan Yadav"},
      {state:"Maharashtra", capital:"Mumbai", cm:"Devendra Fadnavis"},
      {state:"Manipur", capital:"Imphal", cm:"Vacant / President's Rule"},
      {state:"Meghalaya", capital:"Shillong", cm:"Conrad Sangma"},
      {state:"Mizoram", capital:"Aizawl", cm:"Lalduhoma"},
      {state:"Nagaland", capital:"Kohima", cm:"Neiphiu Rio"},
      {state:"Odisha", capital:"Bhubaneswar", cm:"Mohan Charan Majhi"},
      {state:"Punjab", capital:"Chandigarh", cm:"Bhagwant Mann"},
      {state:"Rajasthan", capital:"Jaipur", cm:"Bhajan Lal Sharma"},
      {state:"Sikkim", capital:"Gangtok", cm:"Prem Singh Tamang"},
      {state:"Tamil Nadu", capital:"Chennai", cm:"M. K. Stalin"},
      {state:"Telangana", capital:"Hyderabad", cm:"A. Revanth Reddy"},
      {state:"Tripura", capital:"Agartala", cm:"Manik Saha"},
      {state:"Uttar Pradesh", capital:"Lucknow", cm:"Yogi Adityanath"},
      {state:"Uttarakhand", capital:"Dehradun", cm:"Pushkar Singh Dhami"},
      {state:"West Bengal", capital:"Kolkata", cm:"Mamata Banerjee"}
    ];

    // add CM quick-answers to the bot responses
    for(const s of stateData){
      responses[`cm of ${s.state.toLowerCase()}`] = {
        en: `${s.state}'s Chief Minister is ${s.cm}. Capital is ${s.capital}.`,
        hi: `${s.state} ‡§ï‡•á ‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä ${s.cm} ‡§π‡•à‡§Ç‡•§ ‡§∞‡§æ‡§ú‡§ß‡§æ‡§®‡•Ä ${s.capital} ‡§π‡•à‡•§`,
        roman: `${s.state} ke mukhyamantri ${s.cm} hain. Rajdhani ${s.capital} hai.`
      };
    }

    /* ---------- Lens image handling & OCR ---------- */
    let _capturedImageDataURL = null;
    let _extractedText = "";

    async function startCamera(){
      const camContainer = document.getElementById('camera-container');
      const video = document.getElementById('video');
      const uploadedImage = document.getElementById('uploadedImage');
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
        video.srcObject = stream;
        camContainer.style.display = "block";
        uploadedImage.style.display = "none";
      } catch(e){
        alert("Camera not available or permission denied. Use image upload instead.");
        console.error(e);
      }
    }

    function captureFromCamera(){
      const video = document.getElementById('video');
      if (!video || !video.videoWidth) { alert("Start camera first."); return; }
      const canvas = document.getElementById('overlay');
      canvas.style.display = 'block';
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      _capturedImageDataURL = canvas.toDataURL('image/png');
      document.getElementById('results').innerText = "Image captured. Click Run OCR.";
      document.getElementById('uploadedImage').style.display = 'none';
    }

    function loadImageFromInput(){
      const f = document.getElementById('imageInput').files[0];
      if (!f) { alert("Choose an image file first."); return; }
      const url = URL.createObjectURL(f);
      const uploadedImage = document.getElementById('uploadedImage');
      uploadedImage.src = url;
      uploadedImage.style.display = 'block';
      document.getElementById('camera-container').style.display = 'block';
      const img = new Image();
      img.onload = function(){
        const canvas = document.getElementById('overlay');
        canvas.width = img.naturalWidth;
        canvas.height = img.naturalHeight;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img,0,0);
        _capturedImageDataURL = canvas.toDataURL('image/png');
        document.getElementById('results').innerText = "Image loaded. Click Run OCR.";
      };
      img.src = url;
    }

    async function runOCRNow(){
      if (!_capturedImageDataURL) { alert("No captured/uploaded image. Use camera capture or load an image."); return; }
      const selectedOptions = Array.from(document.getElementById('ocrLangSelect').selectedOptions).map(o=>o.value);
      const langList = selectedOptions.length ? selectedOptions.join('+') : 'eng';
      document.getElementById('results').innerText = `Loading OCR model for ${langList}...`;

      try {
        const { data } = await Tesseract.recognize(
          _capturedImageDataURL,
          langList,
          {
            logger: m => {
              if (m.status && (m.progress !== undefined)) {
                document.getElementById('results').innerText = `${m.status} ‚Äî ${(m.progress*100).toFixed(0)}%`;
              }
            },
            langPath: "https://tessdata.projectnaptha.com/4.0.0"
          }
        );
        _extractedText = (data.text || "").trim();
        document.getElementById('extractedText').value = _extractedText || "(no text detected)";
        document.getElementById('results').innerHTML = `<b>Extracted Text:</b><br>${_extractedText || "(empty)"}<br><span class="muted">Now choose a language and click Translate.</span>`;
      } catch(err){
        console.error(err);
        document.getElementById('results').innerText = "OCR error: see console.";
      }
    }

    async function translateExtracted(){
      const text = (document.getElementById('extractedText').value || "").trim();
      if (!text) { alert("No extracted text. Run OCR first."); return; }
      const target = document.getElementById('transTarget').value || 'hi';
      document.getElementById('translatedBox').innerHTML = "Translating...";
      try {
        const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${encodeURIComponent(target)}&dt=t&q=${encodeURIComponent(text)}`;
        const res = await fetch(url);
        if (!res.ok) throw new Error('Translation endpoint failed');
        const data = await res.json();
        const translated = (data[0] || []).map(seg => seg[0]).join('');
        document.getElementById('translatedBox').innerHTML = `<div style="background:#fff;padding:12px;border-radius:8px;">${translated || "(no translation returned)"}</div>`;
      } catch(e){
        console.error(e);
        // fallback: MyMemory
        try {
          const mm = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=auto|${encodeURIComponent(target)}`);
          const mmdata = await mm.json();
          const txt = mmdata.responseData && mmdata.responseData.translatedText ? mmdata.responseData.translatedText : "(no translation)";
          document.getElementById('translatedBox').innerHTML = `<div style="background:#fff;padding:12px;border-radius:8px;">${txt}</div>`;
        } catch(e2){
          document.getElementById('translatedBox').innerHTML = `<div style="background:#fff;padding:12px;border-radius:8px;">Translation error. See console.</div>`;
        }
      }
    }

    function clearLens(){
      _capturedImageDataURL = null;
      _extractedText = "";
      document.getElementById('results').innerText = "";
      document.getElementById('extractedText').value = "";
      document.getElementById('translatedBox').innerHTML = "";
      document.getElementById('uploadedImage').src = "";
      document.getElementById('uploadedImage').style.display = 'none';
      const canvas = document.getElementById('overlay');
      if (canvas) { const ctx = canvas.getContext('2d'); ctx.clearRect(0,0,canvas.width,canvas.height); canvas.style.display='none'; }
    }

    // auto-load image input change to preview
    document.getElementById('imageInput').addEventListener('change', function(){
      const f = this.files[0];
      if (!f) return;
      const url = URL.createObjectURL(f);
      const imgEl = document.getElementById('uploadedImage');
      const camContainer = document.getElementById('camera-container');
      imgEl.src = url; imgEl.onload = function(){
        camContainer.style.display = 'block'; imgEl.style.display = 'block';
        const canvas = document.getElementById('overlay');
        const ctx = canvas.getContext('2d');
        canvas.width = imgEl.naturalWidth; canvas.height = imgEl.naturalHeight;
        ctx.drawImage(imgEl,0,0);
        _capturedImageDataURL = canvas.toDataURL('image/png');
        document.getElementById('results').innerText = "Image ready. Click Run OCR.";
      };
    });

    // expose functions for inline buttons
    window.runOCRNow = runOCRNow;
    window.translateExtracted = translateExtracted;
    window.startCamera = startCamera;
    window.captureFromCamera = captureFromCamera;
    window.loadImageFromInput = loadImageFromInput;
    window.clearLens = clearLens;
  </script>
</body>
</html>
